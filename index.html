<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Air-gapped, Offline & Hardened Kubernetes Cluster with Kubespray (Runbook)</title>

  <meta name="description" content="Step-by-step runbook for building an air-gapped, offline, hardened, highly available Kubernetes cluster using Kubespray, private container registries and internal OS repositories in restricted environments.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="index,follow">

  <!-- Canonical URL helps avoid duplicate-content confusion -->
  <link rel="canonical" href="https://a-soltani255.github.io/Kubespray/">

  <!-- Open Graph (for social / rich link previews) -->
  <meta property="og:title" content="Air-gapped, Offline & Hardened Kubernetes Cluster with Kubespray">
  <meta property="og:description" content="Runbook and supporting material for building an air-gapped, offline, hardened, highly available Kubernetes cluster using Kubespray, private registries and internal OS mirrors.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://a-soltani255.github.io/Kubespray/">
  <!-- If you create an image at this path, keep this line; otherwise you can delete it -->
  <meta property="og:image" content="https://a-soltani255.github.io/Kubespray/og-image.png">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Air-gapped, Offline & Hardened Kubernetes Cluster with Kubespray">
  <meta name="twitter:description" content="Step-by-step runbook for building an air-gapped, offline, hardened, highly available Kubernetes cluster using Kubespray.">

  <!-- Optional: Google Search Console verification
  <meta name="google-site-verification" content="PASTE_YOUR_TOKEN_HERE" />
  -->

  <!-- Structured data (helps search engines understand the page) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": "Building Air-gapped, Offline & Hardened Kubernetes Clusters with Kubespray",
    "description": "Step-by-step runbook for building an air-gapped, offline, hardened, highly available Kubernetes cluster using Kubespray, private container registries and internal OS repositories.",
    "author": {
      "@type": "Person",
      "name": "Ali Soltaninasab"
    },
    "url": "https://a-soltani255.github.io/Kubespray/",
    "mainEntityOfPage": "https://a-soltani255.github.io/Kubespray/",
    "about": [
      "Kubernetes",
      "Kubespray",
      "Air-gapped Kubernetes cluster",
      "Offline Kubernetes cluster",
      "DevOps",
      "SRE"
    ]
  }
  </script>

  <style>
    :root {
      color-scheme: dark light;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      line-height: 1.6;
      background: #050816;
      color: #e5e7eb;
    }
    a {
      color: #38bdf8;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .page {
      max-width: 900px;
      margin: 0 auto;
      padding: 2.5rem 1.5rem 3rem;
    }
    header h1 {
      font-size: 2.1rem;
      margin-bottom: 0.25rem;
    }
    header p {
      margin-top: 0.25rem;
      color: #9ca3af;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.78rem;
      padding: 0.2rem 0.55rem;
      border-radius: 999px;
      border: 1px solid #374151;
      color: #9ca3af;
      margin-bottom: 1rem;
    }
    .badge-dot {
      width: 0.5rem;
      height: 0.5rem;
      border-radius: 999px;
      background: #22c55e;
    }
    h2 {
      margin-top: 2rem;
      margin-bottom: 0.6rem;
      font-size: 1.3rem;
    }
    ul {
      padding-left: 1.1rem;
    }
    li {
      margin-bottom: 0.2rem;
    }
    .card {
      border-radius: 0.75rem;
      border: 1px solid #1f2933;
      background: radial-gradient(circle at top, #111827 0, #020617 55%);
      padding: 1.25rem 1.4rem;
      margin-top: 1.2rem;
    }
    .card-title {
      font-weight: 600;
      margin-bottom: 0.4rem;
    }
    .primary-link {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      margin-top: 0.8rem;
      padding: 0.5rem 0.9rem;
      border-radius: 999px;
      border: 1px solid #38bdf8;
      background: rgba(56, 189, 248, 0.1);
      font-size: 0.95rem;
    }
    .primary-link span {
      font-size: 1.1rem;
    }
    footer {
      margin-top: 3rem;
      font-size: 0.8rem;
      color: #6b7280;
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="badge">
        <span class="badge-dot"></span>
        <span>DevOps / Kubernetes Platform Engineering</span>
      </div>
      <h1>Building Air-gapped, Offline &amp; Hardened Kubernetes Clusters with Kubespray</h1>
      <p>
        A documentation-first project that walks through building an air-gapped, hardened,
        highly available Kubernetes cluster using Kubespray, with real-world constraints and
        operational details.
      </p>
    </header>

    <section>
      <h2>What this project is about</h2>
      <p>
        Many Kubernetes examples assume full Internet access and a simple single-node cluster.
        This project focuses on <strong>clusters with little or no Internet connectivity</strong>
        and shows how to run <strong>air-gapped and offline Kubernetes clusters</strong>
        with Kubespray.
      </p>
      <ul>
        <li>Fully <strong>air-gapped clusters</strong> with no direct Internet access from Kubernetes nodes</li>
        <li><strong>Offline / disconnected clusters</strong> where you install and operate Kubernetes using internal package repositories and a private container registry</li>
        <li>Multi-node clusters with a highly available control plane</li>
        <li>Opinionated hardening and post-install validation</li>
        <li>A reusable runbook that other engineers can follow end-to-end</li>
      </ul>
    </section>

    <section>
      <h2>Air-gapped vs. Offline – what do we mean?</h2>

      <p>In this project I use two related terms:</p>

      <h3>Offline / disconnected Kubernetes cluster</h3>
      <p>
        A cluster that is installed and operated without relying on direct Internet access.
        All OS packages and container images are served from internal mirrors and registries.
      </p>

      <h3>Air-gapped Kubernetes cluster</h3>
      <p>
        A stricter version of the same idea, where the cluster nodes have
        <strong>no routable path to the public Internet</strong> at all.
        All updates, images and packages must be brought in via bastion hosts, USB,
        or other controlled paths.
      </p>

      <p>
        The runbook and configs in this repo work for <strong>both</strong>:
        you can use them as-is for strict air-gapped environments,
        or adapt them for “just offline” clusters that occasionally sync from an upstream mirror.
      </p>
    </section>

    <section class="card">
      <div class="card-title">Explore the full runbook &amp; configuration</div>
      <p>The GitHub repository contains:</p>
      <ul>
        <li>
          <strong>Main runbook:</strong>
          <code>Installing-Airgapped-Hardened-Kubernetes-Cluster-Using-Kubespray.md</code>
        </li>
        <li>
          <strong>Scripts, appendices and configurations:</strong> example inventories,
          group vars, helper scripts and troubleshooting notes
        </li>
        <li>
          Architecture and operational guidance for bringing up the cluster in an
          air-gapped or offline environment
        </li>
      </ul>
      <a class="primary-link" href="https://github.com/A-Soltani255/Kubespray" target="_blank" rel="noopener">
        <span>➜</span>
        <span>Open the GitHub repository</span>
      </a>
    </section>

        <section>
      <h2>Deep-dive GitHub issues & extended runbooks</h2>
      <p>
        Some of the more advanced parts of this project are documented as
        GitHub issues. These issues act as extended runbooks you can follow
        step by step.
      </p>
      <ul>
        <li>
          <a href="https://github.com/A-Soltani255/Kubespray/issues/2"
             target="_blank" rel="noopener">
            Issue #2 – Removing AlwaysPullImages + Enforcing IfNotPresent
          </a>
          – a detailed runbook for removing the
          <code>AlwaysPullImages</code> admission plugin and enforcing
          <code>k8s_image_pull_policy: IfNotPresent</code> with:
          pre-checks, Kubespray vars cleanup, re-applying
          <code>cluster.yml</code>, fixing kubeadm config / apiserver
          manifests on each control-plane node, and final verification.
        </li>
        <li>
          <a href="https://github.com/A-Soltani255/Kubespray/issues/3"
             target="_blank" rel="noopener">
            Issue #3 – GitLab CI/CD for Kubespray-Based Kubernetes Cluster
          </a>
          – a full design and implementation guide for wiring this
          Kubespray project into GitLab CI/CD, with a shell runner on the
          Kubespray (Ansible) host and jobs like <code>kubespray-full</code>,
          <code>kubespray-cilium</code> and <code>kubespray-custom-cni</code>
          that call <code>ci/run-kubespray.sh</code> and pass Ansible tags
          to re-apply Kubespray safely to the existing cluster.
        </li>
      </ul>
      <p>
        These deep-dive issues complement the main runbook by covering
        day-2 operations such as reconfiguring admission plugins and
        automating Kubespray re-applies through GitLab pipelines.
      </p>
    </section>


    <section>
      <h2>Skills demonstrated</h2>
      <ul>
        <li>Kubernetes cluster provisioning with Kubespray</li>
        <li>Designing and operating <strong>air-gapped and offline / disconnected clusters</strong></li>
        <li>High-availability control plane design</li>
        <li>Private container registry &amp; internal OS repositories</li>
        <li>Security hardening and operational runbooks</li>
      </ul>
    </section>

    <section>
      <h2>Getting started</h2>
      <p>
        To dive into the details, start with the main runbook in the GitHub repository and
        adapt the inventories, group vars and scripts to your own environment
        (IP addressing, OS version, storage, network policies, etc.).
      </p>
      <p>
        For a high-level overview, you can also read the accompanying article on Dev.to,
        which explains the architecture and motivation behind the project.
      </p>
    </section>

    <footer>
      <p>
        This site is published via GitHub Pages for discoverability and as a simple landing
        page for the Kubespray air-gapped / offline Kubernetes cluster project.
      </p>
    </footer>
  </div>
</body>
</html>
